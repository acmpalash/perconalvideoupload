{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Acm/Desktop/Udemy%20Project/Project/Next-js/videoupload/src/lib/mongodb.js"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nexport const connectDB = async () => {\r\n  if (mongoose.connections[0].readyState) return;\r\n\r\n  await mongoose.connect(process.env.MONGODB_URI);\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,YAAY;IACvB,IAAI,kLAAQ,CAAC,WAAW,CAAC,EAAE,CAAC,UAAU,EAAE;IAExC,MAAM,kLAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,WAAW;AAChD"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Acm/Desktop/Udemy%20Project/Project/Next-js/videoupload/src/models/Media.js"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst MediaSchema = new mongoose.Schema(\r\n  {\r\n    url: String,\r\n    type: String, // video | audio\r\n  },\r\n  { timestamps: true }\r\n);\r\n\r\nexport default mongoose.models.Media || mongoose.model(\"Media\", MediaSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,IAAI,kLAAQ,CAAC,MAAM,CACrC;IACE,KAAK;IACL,MAAM;AACR,GACA;IAAE,YAAY;AAAK;uCAGN,kLAAQ,CAAC,MAAM,CAAC,KAAK,IAAI,kLAAQ,CAAC,KAAK,CAAC,SAAS"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Acm/Desktop/Udemy%20Project/Project/Next-js/videoupload/src/app/api/media/upload/route.js"],"sourcesContent":["import cloudinary from \"@/lib/cloudinary\";\r\nimport { connectDB } from \"@/lib/mongodb\";\r\nimport Media from \"@/models/Media\";\r\n\r\nexport async function POST(req) {\r\n  try {\r\n    const formData = await req.formData();\r\n    const file = formData.get(\"file\");\r\n    const secret = formData.get(\"secret\");\r\n\r\n    if (secret !== process.env.ADMIN_SECRET) {\r\n      return new Response(\"Unauthorized\", { status: 401 });\r\n    }\r\n\r\n    const bytes = await file.arrayBuffer();\r\n    const buffer = Buffer.from(bytes);\r\n\r\n    const upload = await new Promise((resolve, reject) => {\r\n      cloudinary.uploader\r\n        .upload_stream({ resource_type: \"auto\" }, (err, result) => {\r\n          if (err) reject(err);\r\n          resolve(result);\r\n        })\r\n        .end(buffer);\r\n    });\r\n\r\n    await connectDB();\r\n\r\n    await Media.create({\r\n      url: upload.secure_url,\r\n      type: upload.resource_type,\r\n    });\r\n\r\n    return Response.json({ success: true });\r\n  } catch (err) {\r\n    return new Response(\"Upload failed\", { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;AACA;AACA;;;;AAEO,eAAe,KAAK,GAAG;IAC5B,IAAI;QACF,MAAM,WAAW,MAAM,IAAI,QAAQ;QACnC,MAAM,OAAO,SAAS,GAAG,CAAC;QAC1B,MAAM,SAAS,SAAS,GAAG,CAAC;QAE5B,IAAI,WAAW,QAAQ,GAAG,CAAC,YAAY,EAAE;YACvC,OAAO,IAAI,SAAS,gBAAgB;gBAAE,QAAQ;YAAI;QACpD;QAEA,MAAM,QAAQ,MAAM,KAAK,WAAW;QACpC,MAAM,SAAS,OAAO,IAAI,CAAC;QAE3B,MAAM,SAAS,MAAM,IAAI,QAAQ,CAAC,SAAS;YACzC,WAAW,QAAQ,CAChB,aAAa,CAAC;gBAAE,eAAe;YAAO,GAAG,CAAC,KAAK;gBAC9C,IAAI,KAAK,OAAO;gBAChB,QAAQ;YACV,GACC,GAAG,CAAC;QACT;QAEA,MAAM,IAAA,mJAAS;QAEf,MAAM,kJAAK,CAAC,MAAM,CAAC;YACjB,KAAK,OAAO,UAAU;YACtB,MAAM,OAAO,aAAa;QAC5B;QAEA,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAK;IACvC,EAAE,OAAO,KAAK;QACZ,OAAO,IAAI,SAAS,iBAAiB;YAAE,QAAQ;QAAI;IACrD;AACF"}}]
}